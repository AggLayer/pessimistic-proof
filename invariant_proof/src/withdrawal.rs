use std::ops::Deref;

use num_bigint::BigInt;
use reth_primitives::{address, revm_primitives::bitvec::view::BitViewSized, Address};
use serde::{Deserialize, Serialize};

use crate::keccak::{keccak256, keccak256_combine};

/// Address of the LXLY bridge contract on Ethereum
const LXLY_EVM_BRIDGE_ETH_MAINNET_ADDR: Address =
    address!("2a3DD3EB832aF982ec71669E178424b10Dca2EDe");

/// The hex-decoded bytecode of (?)
const BASE_INIT_BYTECODE_WRAPPED_TOKEN: [u8; 7014] = [
    97, 1, 0, 96, 64, 82, 52, 128, 21, 98, 0, 0, 18, 87, 96, 0, 128, 253, 91, 80, 96, 64, 81, 98,
    0, 27, 102, 56, 3, 128, 98, 0, 27, 102, 131, 57, 129, 1, 96, 64, 129, 144, 82, 98, 0, 0, 53,
    145, 98, 0, 2, 141, 86, 91, 130, 130, 96, 3, 98, 0, 0, 69, 131, 130, 98, 0, 3, 161, 86, 91, 80,
    96, 4, 98, 0, 0, 84, 130, 130, 98, 0, 3, 161, 86, 91, 80, 80, 51, 96, 192, 82, 80, 96, 255,
    129, 22, 96, 224, 82, 70, 96, 128, 129, 144, 82, 98, 0, 0, 115, 144, 98, 0, 0, 128, 86, 91, 96,
    160, 82, 80, 98, 0, 4, 109, 145, 80, 80, 86, 91, 96, 0, 127, 139, 115, 195, 198, 155, 184, 254,
    61, 81, 46, 204, 76, 247, 89, 204, 121, 35, 159, 123, 23, 155, 15, 250, 202, 169, 167, 93, 82,
    43, 57, 64, 15, 98, 0, 0, 173, 98, 0, 1, 46, 86, 91, 128, 81, 96, 32, 145, 130, 1, 32, 96, 64,
    128, 81, 128, 130, 1, 130, 82, 96, 1, 129, 82, 96, 49, 96, 248, 27, 144, 132, 1, 82, 128, 81,
    146, 131, 1, 147, 144, 147, 82, 145, 129, 1, 145, 144, 145, 82, 127, 200, 158, 253, 170, 84,
    192, 242, 12, 122, 223, 97, 40, 130, 223, 9, 80, 245, 169, 81, 99, 126, 3, 7, 205, 203, 76,
    103, 47, 41, 139, 139, 198, 96, 96, 130, 1, 82, 96, 128, 129, 1, 131, 144, 82, 48, 96, 160,
    130, 1, 82, 96, 192, 1, 96, 64, 81, 96, 32, 129, 131, 3, 3, 129, 82, 144, 96, 64, 82, 128, 81,
    144, 96, 32, 1, 32, 144, 80, 145, 144, 80, 86, 91, 96, 96, 96, 3, 128, 84, 98, 0, 1, 63, 144,
    98, 0, 3, 18, 86, 91, 128, 96, 31, 1, 96, 32, 128, 145, 4, 2, 96, 32, 1, 96, 64, 81, 144, 129,
    1, 96, 64, 82, 128, 146, 145, 144, 129, 129, 82, 96, 32, 1, 130, 128, 84, 98, 0, 1, 109, 144,
    98, 0, 3, 18, 86, 91, 128, 21, 98, 0, 1, 190, 87, 128, 96, 31, 16, 98, 0, 1, 146, 87, 97, 1, 0,
    128, 131, 84, 4, 2, 131, 82, 145, 96, 32, 1, 145, 98, 0, 1, 190, 86, 91, 130, 1, 145, 144, 96,
    0, 82, 96, 32, 96, 0, 32, 144, 91, 129, 84, 129, 82, 144, 96, 1, 1, 144, 96, 32, 1, 128, 131,
    17, 98, 0, 1, 160, 87, 130, 144, 3, 96, 31, 22, 130, 1, 145, 91, 80, 80, 80, 80, 80, 144, 80,
    144, 86, 91, 99, 78, 72, 123, 113, 96, 224, 27, 96, 0, 82, 96, 65, 96, 4, 82, 96, 36, 96, 0,
    253, 91, 96, 0, 130, 96, 31, 131, 1, 18, 98, 0, 1, 240, 87, 96, 0, 128, 253, 91, 129, 81, 96,
    1, 96, 1, 96, 64, 27, 3, 128, 130, 17, 21, 98, 0, 2, 13, 87, 98, 0, 2, 13, 98, 0, 1, 200, 86,
    91, 96, 64, 81, 96, 31, 131, 1, 96, 31, 25, 144, 129, 22, 96, 63, 1, 22, 129, 1, 144, 130, 130,
    17, 129, 131, 16, 23, 21, 98, 0, 2, 56, 87, 98, 0, 2, 56, 98, 0, 1, 200, 86, 91, 129, 96, 64,
    82, 131, 129, 82, 96, 32, 146, 80, 134, 131, 133, 136, 1, 1, 17, 21, 98, 0, 2, 85, 87, 96, 0,
    128, 253, 91, 96, 0, 145, 80, 91, 131, 130, 16, 21, 98, 0, 2, 121, 87, 133, 130, 1, 131, 1, 81,
    129, 131, 1, 132, 1, 82, 144, 130, 1, 144, 98, 0, 2, 90, 86, 91, 96, 0, 147, 129, 1, 144, 146,
    1, 146, 144, 146, 82, 148, 147, 80, 80, 80, 80, 86, 91, 96, 0, 128, 96, 0, 96, 96, 132, 134, 3,
    18, 21, 98, 0, 2, 163, 87, 96, 0, 128, 253, 91, 131, 81, 96, 1, 96, 1, 96, 64, 27, 3, 128, 130,
    17, 21, 98, 0, 2, 187, 87, 96, 0, 128, 253, 91, 98, 0, 2, 201, 135, 131, 136, 1, 98, 0, 1, 222,
    86, 91, 148, 80, 96, 32, 134, 1, 81, 145, 80, 128, 130, 17, 21, 98, 0, 2, 224, 87, 96, 0, 128,
    253, 91, 80, 98, 0, 2, 239, 134, 130, 135, 1, 98, 0, 1, 222, 86, 91, 146, 80, 80, 96, 64, 132,
    1, 81, 96, 255, 129, 22, 129, 20, 98, 0, 3, 7, 87, 96, 0, 128, 253, 91, 128, 145, 80, 80, 146,
    80, 146, 80, 146, 86, 91, 96, 1, 129, 129, 28, 144, 130, 22, 128, 98, 0, 3, 39, 87, 96, 127,
    130, 22, 145, 80, 91, 96, 32, 130, 16, 129, 3, 98, 0, 3, 72, 87, 99, 78, 72, 123, 113, 96, 224,
    27, 96, 0, 82, 96, 34, 96, 4, 82, 96, 36, 96, 0, 253, 91, 80, 145, 144, 80, 86, 91, 96, 31,
    130, 17, 21, 98, 0, 3, 156, 87, 96, 0, 129, 129, 82, 96, 32, 129, 32, 96, 31, 133, 1, 96, 5,
    28, 129, 1, 96, 32, 134, 16, 21, 98, 0, 3, 119, 87, 80, 128, 91, 96, 31, 133, 1, 96, 5, 28,
    130, 1, 145, 80, 91, 129, 129, 16, 21, 98, 0, 3, 152, 87, 130, 129, 85, 96, 1, 1, 98, 0, 3,
    131, 86, 91, 80, 80, 80, 91, 80, 80, 80, 86, 91, 129, 81, 96, 1, 96, 1, 96, 64, 27, 3, 129, 17,
    21, 98, 0, 3, 189, 87, 98, 0, 3, 189, 98, 0, 1, 200, 86, 91, 98, 0, 3, 213, 129, 98, 0, 3, 206,
    132, 84, 98, 0, 3, 18, 86, 91, 132, 98, 0, 3, 78, 86, 91, 96, 32, 128, 96, 31, 131, 17, 96, 1,
    129, 20, 98, 0, 4, 13, 87, 96, 0, 132, 21, 98, 0, 3, 244, 87, 80, 133, 131, 1, 81, 91, 96, 0,
    25, 96, 3, 134, 144, 27, 28, 25, 22, 96, 1, 133, 144, 27, 23, 133, 85, 98, 0, 3, 152, 86, 91,
    96, 0, 133, 129, 82, 96, 32, 129, 32, 96, 31, 25, 134, 22, 145, 91, 130, 129, 16, 21, 98, 0, 4,
    62, 87, 136, 134, 1, 81, 130, 85, 148, 132, 1, 148, 96, 1, 144, 145, 1, 144, 132, 1, 98, 0, 4,
    29, 86, 91, 80, 133, 130, 16, 21, 98, 0, 4, 93, 87, 135, 133, 1, 81, 96, 0, 25, 96, 3, 136,
    144, 27, 96, 248, 22, 28, 25, 22, 129, 85, 91, 80, 80, 80, 80, 80, 96, 1, 144, 129, 27, 1, 144,
    85, 80, 86, 91, 96, 128, 81, 96, 160, 81, 96, 192, 81, 96, 224, 81, 97, 22, 170, 98, 0, 4, 188,
    96, 0, 57, 96, 0, 97, 2, 55, 1, 82, 96, 0, 129, 129, 97, 3, 7, 1, 82, 129, 129, 97, 5, 192, 1,
    82, 97, 6, 167, 1, 82, 96, 0, 97, 5, 58, 1, 82, 96, 0, 129, 129, 97, 3, 121, 1, 82, 97, 5, 4,
    1, 82, 97, 22, 170, 96, 0, 243, 254, 96, 128, 96, 64, 82, 52, 128, 21, 97, 0, 16, 87, 96, 0,
    128, 253, 91, 80, 96, 4, 54, 16, 97, 1, 119, 87, 96, 0, 53, 96, 224, 28, 128, 99, 112, 160,
    130, 49, 17, 97, 0, 216, 87, 128, 99, 164, 87, 194, 215, 17, 97, 0, 140, 87, 128, 99, 213, 5,
    172, 207, 17, 97, 0, 102, 87, 128, 99, 213, 5, 172, 207, 20, 97, 3, 155, 87, 128, 99, 221, 98,
    237, 62, 20, 97, 3, 174, 87, 128, 99, 255, 161, 173, 116, 20, 97, 3, 244, 87, 96, 0, 128, 253,
    91, 128, 99, 164, 87, 194, 215, 20, 97, 3, 78, 87, 128, 99, 169, 5, 156, 187, 20, 97, 3, 97,
    87, 128, 99, 205, 13, 0, 150, 20, 97, 3, 116, 87, 96, 0, 128, 253, 91, 128, 99, 149, 216, 155,
    65, 17, 97, 0, 189, 87, 128, 99, 149, 216, 155, 65, 20, 97, 2, 231, 87, 128, 99, 157, 194, 159,
    172, 20, 97, 2, 239, 87, 128, 99, 163, 197, 115, 235, 20, 97, 3, 2, 87, 96, 0, 128, 253, 91,
    128, 99, 112, 160, 130, 49, 20, 97, 2, 145, 87, 128, 99, 126, 206, 190, 0, 20, 97, 2, 199, 87,
    96, 0, 128, 253, 91, 128, 99, 48, 173, 248, 31, 17, 97, 1, 47, 87, 128, 99, 54, 68, 229, 21,
    17, 97, 1, 20, 87, 128, 99, 54, 68, 229, 21, 20, 97, 2, 97, 87, 128, 99, 57, 80, 147, 81, 20,
    97, 2, 105, 87, 128, 99, 64, 193, 15, 25, 20, 97, 2, 124, 87, 96, 0, 128, 253, 91, 128, 99, 48,
    173, 248, 31, 20, 97, 2, 9, 87, 128, 99, 49, 60, 229, 103, 20, 97, 2, 48, 87, 96, 0, 128, 253,
    91, 128, 99, 24, 22, 13, 221, 17, 97, 1, 96, 87, 128, 99, 24, 22, 13, 221, 20, 97, 1, 189, 87,
    128, 99, 32, 96, 107, 112, 20, 97, 1, 207, 87, 128, 99, 35, 184, 114, 221, 20, 97, 1, 246, 87,
    96, 0, 128, 253, 91, 128, 99, 6, 253, 222, 3, 20, 97, 1, 124, 87, 128, 99, 9, 94, 167, 179, 20,
    97, 1, 154, 87, 91, 96, 0, 128, 253, 91, 97, 1, 132, 97, 4, 48, 86, 91, 96, 64, 81, 97, 1, 145,
    145, 144, 97, 19, 228, 86, 91, 96, 64, 81, 128, 145, 3, 144, 243, 91, 97, 1, 173, 97, 1, 168,
    54, 96, 4, 97, 20, 121, 86, 91, 97, 4, 194, 86, 91, 96, 64, 81, 144, 21, 21, 129, 82, 96, 32,
    1, 97, 1, 145, 86, 91, 96, 2, 84, 91, 96, 64, 81, 144, 129, 82, 96, 32, 1, 97, 1, 145, 86, 91,
    97, 1, 193, 127, 139, 115, 195, 198, 155, 184, 254, 61, 81, 46, 204, 76, 247, 89, 204, 121, 35,
    159, 123, 23, 155, 15, 250, 202, 169, 167, 93, 82, 43, 57, 64, 15, 129, 86, 91, 97, 1, 173, 97,
    2, 4, 54, 96, 4, 97, 20, 163, 86, 91, 97, 4, 220, 86, 91, 97, 1, 193, 127, 110, 113, 237, 174,
    18, 177, 185, 127, 77, 31, 96, 55, 15, 239, 16, 16, 95, 162, 250, 174, 1, 38, 17, 74, 22, 156,
    100, 132, 93, 97, 38, 201, 129, 86, 91, 96, 64, 81, 96, 255, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 129, 82, 96, 32, 1, 97,
    1, 145, 86, 91, 97, 1, 193, 97, 5, 0, 86, 91, 97, 1, 173, 97, 2, 119, 54, 96, 4, 97, 20, 121,
    86, 91, 97, 5, 92, 86, 91, 97, 2, 143, 97, 2, 138, 54, 96, 4, 97, 20, 121, 86, 91, 97, 5, 168,
    86, 91, 0, 91, 97, 1, 193, 97, 2, 159, 54, 96, 4, 97, 20, 223, 86, 91, 115, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 22, 96, 0, 144,
    129, 82, 96, 32, 129, 144, 82, 96, 64, 144, 32, 84, 144, 86, 91, 97, 1, 193, 97, 2, 213, 54,
    96, 4, 97, 20, 223, 86, 91, 96, 5, 96, 32, 82, 96, 0, 144, 129, 82, 96, 64, 144, 32, 84, 129,
    86, 91, 97, 1, 132, 97, 6, 128, 86, 91, 97, 2, 143, 97, 2, 253, 54, 96, 4, 97, 20, 121, 86, 91,
    97, 6, 143, 86, 91, 97, 3, 41, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 86, 91, 96, 64, 81, 115, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 144, 145, 22, 129, 82,
    96, 32, 1, 97, 1, 145, 86, 91, 97, 1, 173, 97, 3, 92, 54, 96, 4, 97, 20, 121, 86, 91, 97, 7,
    94, 86, 91, 97, 1, 173, 97, 3, 111, 54, 96, 4, 97, 20, 121, 86, 91, 97, 8, 47, 86, 91, 97, 1,
    193, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 129, 86, 91, 97, 2, 143, 97, 3, 169, 54, 96, 4, 97, 21, 1, 86, 91, 97, 8, 61, 86,
    91, 97, 1, 193, 97, 3, 188, 54, 96, 4, 97, 21, 116, 86, 91, 115, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 145, 130, 22, 96, 0, 144,
    129, 82, 96, 1, 96, 32, 144, 129, 82, 96, 64, 128, 131, 32, 147, 144, 148, 22, 130, 82, 145,
    144, 145, 82, 32, 84, 144, 86, 91, 97, 1, 132, 96, 64, 81, 128, 96, 64, 1, 96, 64, 82, 128, 96,
    1, 129, 82, 96, 32, 1, 127, 49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 80, 129, 86, 91, 96, 96, 96, 3, 128, 84, 97, 4, 63, 144,
    97, 21, 167, 86, 91, 128, 96, 31, 1, 96, 32, 128, 145, 4, 2, 96, 32, 1, 96, 64, 81, 144, 129,
    1, 96, 64, 82, 128, 146, 145, 144, 129, 129, 82, 96, 32, 1, 130, 128, 84, 97, 4, 107, 144, 97,
    21, 167, 86, 91, 128, 21, 97, 4, 184, 87, 128, 96, 31, 16, 97, 4, 141, 87, 97, 1, 0, 128, 131,
    84, 4, 2, 131, 82, 145, 96, 32, 1, 145, 97, 4, 184, 86, 91, 130, 1, 145, 144, 96, 0, 82, 96,
    32, 96, 0, 32, 144, 91, 129, 84, 129, 82, 144, 96, 1, 1, 144, 96, 32, 1, 128, 131, 17, 97, 4,
    155, 87, 130, 144, 3, 96, 31, 22, 130, 1, 145, 91, 80, 80, 80, 80, 80, 144, 80, 144, 86, 91,
    96, 0, 51, 97, 4, 208, 129, 133, 133, 97, 11, 115, 86, 91, 96, 1, 145, 80, 80, 91, 146, 145,
    80, 80, 86, 91, 96, 0, 51, 97, 4, 234, 133, 130, 133, 97, 13, 39, 86, 91, 97, 4, 245, 133, 133,
    133, 97, 13, 254, 86, 91, 80, 96, 1, 148, 147, 80, 80, 80, 80, 86, 91, 96, 0, 127, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 70, 20, 97,
    5, 55, 87, 97, 5, 50, 70, 97, 16, 109, 86, 91, 144, 80, 144, 86, 91, 80, 127, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 144, 86, 91, 51,
    96, 0, 129, 129, 82, 96, 1, 96, 32, 144, 129, 82, 96, 64, 128, 131, 32, 115, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 135, 22,
    132, 82, 144, 145, 82, 129, 32, 84, 144, 145, 144, 97, 4, 208, 144, 130, 144, 134, 144, 97, 5,
    163, 144, 135, 144, 97, 22, 41, 86, 91, 97, 11, 115, 86, 91, 51, 115, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 127, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 20, 97, 6,
    114, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 48, 96, 36, 130, 1,
    82, 127, 84, 111, 107, 101, 110, 87, 114, 97, 112, 112, 101, 100, 58, 58, 111, 110, 108, 121,
    66, 114, 105, 100, 103, 101, 58, 32, 78, 111, 116, 32, 80, 111, 96, 68, 130, 1, 82, 127, 108,
    121, 103, 111, 110, 90, 107, 69, 86, 77, 66, 114, 105, 100, 103, 101, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 91, 96, 64, 81, 128, 145, 3, 144, 253,
    91, 97, 6, 124, 130, 130, 97, 17, 53, 86, 91, 80, 80, 86, 91, 96, 96, 96, 4, 128, 84, 97, 4,
    63, 144, 97, 21, 167, 86, 91, 51, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 127, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 20, 97, 7, 84, 87, 96, 64, 81, 127, 8,
    195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 48, 96, 36, 130, 1, 82, 127, 84, 111, 107, 101, 110,
    87, 114, 97, 112, 112, 101, 100, 58, 58, 111, 110, 108, 121, 66, 114, 105, 100, 103, 101, 58,
    32, 78, 111, 116, 32, 80, 111, 96, 68, 130, 1, 82, 127, 108, 121, 103, 111, 110, 90, 107, 69,
    86, 77, 66, 114, 105, 100, 103, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100,
    130, 1, 82, 96, 132, 1, 97, 6, 105, 86, 91, 97, 6, 124, 130, 130, 97, 18, 40, 86, 91, 51, 96,
    0, 129, 129, 82, 96, 1, 96, 32, 144, 129, 82, 96, 64, 128, 131, 32, 115, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 135, 22, 132,
    82, 144, 145, 82, 129, 32, 84, 144, 145, 144, 131, 129, 16, 21, 97, 8, 34, 87, 96, 64, 81, 127,
    8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 37, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48,
    58, 32, 100, 101, 99, 114, 101, 97, 115, 101, 100, 32, 97, 108, 108, 111, 119, 97, 110, 99,
    101, 32, 98, 101, 108, 111, 119, 96, 68, 130, 1, 82, 127, 32, 122, 101, 114, 111, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96,
    132, 1, 97, 6, 105, 86, 91, 97, 4, 245, 130, 134, 134, 132, 3, 97, 11, 115, 86, 91, 96, 0, 51,
    97, 4, 208, 129, 133, 133, 97, 13, 254, 86, 91, 131, 66, 17, 21, 97, 8, 204, 87, 96, 64, 81,
    127, 8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 36, 128, 130, 1, 82, 127, 84, 111, 107,
    101, 110, 87, 114, 97, 112, 112, 101, 100, 58, 58, 112, 101, 114, 109, 105, 116, 58, 32, 69,
    120, 112, 105, 114, 101, 100, 32, 112, 101, 96, 68, 130, 1, 82, 127, 114, 109, 105, 116, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1,
    82, 96, 132, 1, 97, 6, 105, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 135, 22, 96, 0, 144, 129, 82, 96, 5, 96, 32, 82,
    96, 64, 129, 32, 128, 84, 127, 110, 113, 237, 174, 18, 177, 185, 127, 77, 31, 96, 55, 15, 239,
    16, 16, 95, 162, 250, 174, 1, 38, 17, 74, 22, 156, 100, 132, 93, 97, 38, 201, 145, 138, 145,
    138, 145, 138, 145, 144, 134, 97, 9, 38, 131, 97, 22, 60, 86, 91, 144, 145, 85, 80, 96, 64,
    128, 81, 96, 32, 129, 1, 150, 144, 150, 82, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 148, 133, 22, 144, 134, 1, 82, 146, 144,
    145, 22, 96, 96, 132, 1, 82, 96, 128, 131, 1, 82, 96, 160, 130, 1, 82, 96, 192, 129, 1, 134,
    144, 82, 96, 224, 1, 96, 64, 81, 96, 32, 129, 131, 3, 3, 129, 82, 144, 96, 64, 82, 128, 81,
    144, 96, 32, 1, 32, 144, 80, 96, 0, 97, 9, 145, 97, 5, 0, 86, 91, 96, 64, 81, 127, 25, 1, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 32,
    130, 1, 82, 96, 34, 129, 1, 145, 144, 145, 82, 96, 66, 129, 1, 131, 144, 82, 96, 98, 1, 96, 64,
    128, 81, 127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 224, 129, 132, 3, 1,
    129, 82, 130, 130, 82, 128, 81, 96, 32, 145, 130, 1, 32, 96, 0, 128, 133, 82, 145, 132, 1, 128,
    132, 82, 129, 144, 82, 96, 255, 137, 22, 146, 132, 1, 146, 144, 146, 82, 96, 96, 131, 1, 135,
    144, 82, 96, 128, 131, 1, 134, 144, 82, 144, 146, 80, 144, 96, 1, 144, 96, 160, 1, 96, 32, 96,
    64, 81, 96, 32, 129, 3, 144, 128, 132, 3, 144, 133, 90, 250, 21, 128, 21, 97, 10, 85, 87, 61,
    96, 0, 128, 62, 61, 96, 0, 253, 91, 80, 80, 96, 64, 81, 127, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 224, 1, 81, 145, 80, 80, 115, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 129, 22, 21, 128, 21, 144, 97, 10,
    208, 87, 80, 137, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 22, 129, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 22, 20, 91, 97, 11, 92, 87, 96, 64, 81, 127,
    8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 39, 96, 36, 130, 1, 82, 127, 84, 111, 107, 101,
    110, 87, 114, 97, 112, 112, 101, 100, 58, 58, 112, 101, 114, 109, 105, 116, 58, 32, 73, 110,
    118, 97, 108, 105, 100, 32, 115, 105, 96, 68, 130, 1, 82, 127, 103, 110, 97, 116, 117, 114,
    101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130,
    1, 82, 96, 132, 1, 97, 6, 105, 86, 91, 97, 11, 103, 138, 138, 138, 97, 11, 115, 86, 91, 80, 80,
    80, 80, 80, 80, 80, 80, 80, 80, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 131, 22, 97, 12, 21, 87, 96, 64, 81, 127, 8,
    195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 36, 128, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58,
    32, 97, 112, 112, 114, 111, 118, 101, 32, 102, 114, 111, 109, 32, 116, 104, 101, 32, 122, 101,
    114, 111, 32, 97, 100, 100, 96, 68, 130, 1, 82, 127, 114, 101, 115, 115, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1,
    97, 6, 105, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 130, 22, 97, 12, 184, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96,
    32, 96, 4, 130, 1, 82, 96, 34, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 97, 112,
    112, 114, 111, 118, 101, 32, 116, 111, 32, 116, 104, 101, 32, 122, 101, 114, 111, 32, 97, 100,
    100, 114, 101, 96, 68, 130, 1, 82, 127, 115, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6, 105, 86,
    91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 131, 129, 22, 96, 0, 129, 129, 82, 96, 1, 96, 32, 144, 129, 82, 96, 64, 128,
    131, 32, 148, 135, 22, 128, 132, 82, 148, 130, 82, 145, 130, 144, 32, 133, 144, 85, 144, 81,
    132, 129, 82, 127, 140, 91, 225, 229, 235, 236, 125, 91, 209, 79, 113, 66, 125, 30, 132, 243,
    221, 3, 20, 192, 247, 178, 41, 30, 91, 32, 10, 200, 199, 195, 185, 37, 145, 1, 91, 96, 64, 81,
    128, 145, 3, 144, 163, 80, 80, 80, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 131, 129, 22, 96, 0, 144, 129, 82, 96,
    1, 96, 32, 144, 129, 82, 96, 64, 128, 131, 32, 147, 134, 22, 131, 82, 146, 144, 82, 32, 84,
    127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 129, 20, 97, 13, 248, 87,
    129, 129, 16, 21, 97, 13, 235, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82,
    96, 29, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 105, 110, 115, 117, 102, 102, 105,
    99, 105, 101, 110, 116, 32, 97, 108, 108, 111, 119, 97, 110, 99, 101, 0, 0, 0, 96, 68, 130, 1,
    82, 96, 100, 1, 97, 6, 105, 86, 91, 97, 13, 248, 132, 132, 132, 132, 3, 97, 11, 115, 86, 91,
    80, 80, 80, 80, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 131, 22, 97, 14, 161, 87, 96, 64, 81, 127, 8, 195, 121, 160,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82,
    96, 32, 96, 4, 130, 1, 82, 96, 37, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 116,
    114, 97, 110, 115, 102, 101, 114, 32, 102, 114, 111, 109, 32, 116, 104, 101, 32, 122, 101, 114,
    111, 32, 97, 100, 96, 68, 130, 1, 82, 127, 100, 114, 101, 115, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6,
    105, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 130, 22, 97, 15, 68, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96,
    4, 130, 1, 82, 96, 35, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 116, 114, 97, 110,
    115, 102, 101, 114, 32, 116, 111, 32, 116, 104, 101, 32, 122, 101, 114, 111, 32, 97, 100, 100,
    114, 96, 68, 130, 1, 82, 127, 101, 115, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6, 105, 86, 91, 115,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 131, 22, 96, 0, 144, 129, 82, 96, 32, 129, 144, 82, 96, 64, 144, 32, 84, 129, 129, 16, 21,
    97, 15, 250, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82, 96, 38, 96, 36,
    130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 116, 114, 97, 110, 115, 102, 101, 114, 32, 97,
    109, 111, 117, 110, 116, 32, 101, 120, 99, 101, 101, 100, 115, 32, 98, 96, 68, 130, 1, 82, 127,
    97, 108, 97, 110, 99, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6, 105, 86, 91, 115, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 132, 129, 22, 96, 0,
    129, 129, 82, 96, 32, 129, 129, 82, 96, 64, 128, 131, 32, 135, 135, 3, 144, 85, 147, 135, 22,
    128, 131, 82, 145, 132, 144, 32, 128, 84, 135, 1, 144, 85, 146, 81, 133, 129, 82, 144, 146,
    127, 221, 242, 82, 173, 27, 226, 200, 155, 105, 194, 176, 104, 252, 55, 141, 170, 149, 43, 167,
    241, 99, 196, 161, 22, 40, 245, 90, 77, 245, 35, 179, 239, 145, 1, 96, 64, 81, 128, 145, 3,
    144, 163, 97, 13, 248, 86, 91, 96, 0, 127, 139, 115, 195, 198, 155, 184, 254, 61, 81, 46, 204,
    76, 247, 89, 204, 121, 35, 159, 123, 23, 155, 15, 250, 202, 169, 167, 93, 82, 43, 57, 64, 15,
    97, 16, 152, 97, 4, 48, 86, 91, 128, 81, 96, 32, 145, 130, 1, 32, 96, 64, 128, 81, 128, 130, 1,
    130, 82, 96, 1, 129, 82, 127, 49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 144, 132, 1, 82, 128, 81, 146, 131, 1, 147, 144, 147, 82, 145,
    129, 1, 145, 144, 145, 82, 127, 200, 158, 253, 170, 84, 192, 242, 12, 122, 223, 97, 40, 130,
    223, 9, 80, 245, 169, 81, 99, 126, 3, 7, 205, 203, 76, 103, 47, 41, 139, 139, 198, 96, 96, 130,
    1, 82, 96, 128, 129, 1, 131, 144, 82, 48, 96, 160, 130, 1, 82, 96, 192, 1, 96, 64, 81, 96, 32,
    129, 131, 3, 3, 129, 82, 144, 96, 64, 82, 128, 81, 144, 96, 32, 1, 32, 144, 80, 145, 144, 80,
    86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 130, 22, 97, 17, 178, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96, 4,
    130, 1, 82, 96, 31, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 109, 105, 110, 116,
    32, 116, 111, 32, 116, 104, 101, 32, 122, 101, 114, 111, 32, 97, 100, 100, 114, 101, 115, 115,
    0, 96, 68, 130, 1, 82, 96, 100, 1, 97, 6, 105, 86, 91, 128, 96, 2, 96, 0, 130, 130, 84, 97, 17,
    196, 145, 144, 97, 22, 41, 86, 91, 144, 145, 85, 80, 80, 115, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 130, 22, 96, 0, 129, 129,
    82, 96, 32, 129, 129, 82, 96, 64, 128, 131, 32, 128, 84, 134, 1, 144, 85, 81, 132, 129, 82,
    127, 221, 242, 82, 173, 27, 226, 200, 155, 105, 194, 176, 104, 252, 55, 141, 170, 149, 43, 167,
    241, 99, 196, 161, 22, 40, 245, 90, 77, 245, 35, 179, 239, 145, 1, 96, 64, 81, 128, 145, 3,
    144, 163, 80, 80, 86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 130, 22, 97, 18, 203, 87, 96, 64, 81, 127, 8, 195, 121, 160,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82,
    96, 32, 96, 4, 130, 1, 82, 96, 33, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 98,
    117, 114, 110, 32, 102, 114, 111, 109, 32, 116, 104, 101, 32, 122, 101, 114, 111, 32, 97, 100,
    100, 114, 101, 115, 96, 68, 130, 1, 82, 127, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6, 105,
    86, 91, 115, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 130, 22, 96, 0, 144, 129, 82, 96, 32, 129, 144, 82, 96, 64, 144, 32, 84,
    129, 129, 16, 21, 97, 19, 129, 87, 96, 64, 81, 127, 8, 195, 121, 160, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129, 82, 96, 32, 96, 4, 130, 1, 82,
    96, 34, 96, 36, 130, 1, 82, 127, 69, 82, 67, 50, 48, 58, 32, 98, 117, 114, 110, 32, 97, 109,
    111, 117, 110, 116, 32, 101, 120, 99, 101, 101, 100, 115, 32, 98, 97, 108, 97, 110, 96, 68,
    130, 1, 82, 127, 99, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 96, 100, 130, 1, 82, 96, 132, 1, 97, 6, 105, 86, 91, 115, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 131, 22,
    96, 0, 129, 129, 82, 96, 32, 129, 129, 82, 96, 64, 128, 131, 32, 134, 134, 3, 144, 85, 96, 2,
    128, 84, 135, 144, 3, 144, 85, 81, 133, 129, 82, 145, 146, 145, 127, 221, 242, 82, 173, 27,
    226, 200, 155, 105, 194, 176, 104, 252, 55, 141, 170, 149, 43, 167, 241, 99, 196, 161, 22, 40,
    245, 90, 77, 245, 35, 179, 239, 145, 1, 97, 13, 26, 86, 91, 96, 0, 96, 32, 128, 131, 82, 131,
    81, 128, 130, 133, 1, 82, 96, 0, 91, 129, 129, 16, 21, 97, 20, 17, 87, 133, 129, 1, 131, 1, 81,
    133, 130, 1, 96, 64, 1, 82, 130, 1, 97, 19, 245, 86, 91, 80, 96, 0, 96, 64, 130, 134, 1, 1, 82,
    96, 64, 127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 224, 96, 31, 131, 1,
    22, 133, 1, 1, 146, 80, 80, 80, 146, 145, 80, 80, 86, 91, 128, 53, 115, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 129, 22, 129,
    20, 97, 20, 116, 87, 96, 0, 128, 253, 91, 145, 144, 80, 86, 91, 96, 0, 128, 96, 64, 131, 133,
    3, 18, 21, 97, 20, 140, 87, 96, 0, 128, 253, 91, 97, 20, 149, 131, 97, 20, 80, 86, 91, 148, 96,
    32, 147, 144, 147, 1, 53, 147, 80, 80, 80, 86, 91, 96, 0, 128, 96, 0, 96, 96, 132, 134, 3, 18,
    21, 97, 20, 184, 87, 96, 0, 128, 253, 91, 97, 20, 193, 132, 97, 20, 80, 86, 91, 146, 80, 97,
    20, 207, 96, 32, 133, 1, 97, 20, 80, 86, 91, 145, 80, 96, 64, 132, 1, 53, 144, 80, 146, 80,
    146, 80, 146, 86, 91, 96, 0, 96, 32, 130, 132, 3, 18, 21, 97, 20, 241, 87, 96, 0, 128, 253, 91,
    97, 20, 250, 130, 97, 20, 80, 86, 91, 147, 146, 80, 80, 80, 86, 91, 96, 0, 128, 96, 0, 128, 96,
    0, 128, 96, 0, 96, 224, 136, 138, 3, 18, 21, 97, 21, 28, 87, 96, 0, 128, 253, 91, 97, 21, 37,
    136, 97, 20, 80, 86, 91, 150, 80, 97, 21, 51, 96, 32, 137, 1, 97, 20, 80, 86, 91, 149, 80, 96,
    64, 136, 1, 53, 148, 80, 96, 96, 136, 1, 53, 147, 80, 96, 128, 136, 1, 53, 96, 255, 129, 22,
    129, 20, 97, 21, 87, 87, 96, 0, 128, 253, 91, 150, 153, 149, 152, 80, 147, 150, 146, 149, 148,
    96, 160, 132, 1, 53, 148, 80, 96, 192, 144, 147, 1, 53, 146, 145, 80, 80, 86, 91, 96, 0, 128,
    96, 64, 131, 133, 3, 18, 21, 97, 21, 135, 87, 96, 0, 128, 253, 91, 97, 21, 144, 131, 97, 20,
    80, 86, 91, 145, 80, 97, 21, 158, 96, 32, 132, 1, 97, 20, 80, 86, 91, 144, 80, 146, 80, 146,
    144, 80, 86, 91, 96, 1, 129, 129, 28, 144, 130, 22, 128, 97, 21, 187, 87, 96, 127, 130, 22,
    145, 80, 91, 96, 32, 130, 16, 129, 3, 97, 21, 244, 87, 127, 78, 72, 123, 113, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 0, 82, 96, 34, 96, 4, 82,
    96, 36, 96, 0, 253, 91, 80, 145, 144, 80, 86, 91, 127, 78, 72, 123, 113, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 96, 0, 82, 96, 17, 96, 4, 82,
    96, 36, 96, 0, 253, 91, 128, 130, 1, 128, 130, 17, 21, 97, 4, 214, 87, 97, 4, 214, 97, 21, 250,
    86, 91, 96, 0, 127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 130, 3,
    97, 22, 109, 87, 97, 22, 109, 97, 21, 250, 86, 91, 80, 96, 1, 1, 144, 86, 254, 162, 100, 105,
    112, 102, 115, 88, 34, 18, 32, 141, 136, 254, 229, 97, 207, 247, 18, 13, 56, 28, 52, 92, 252,
    83, 76, 239, 130, 41, 162, 114, 220, 88, 9, 212, 187, 182, 133, 173, 103, 20, 17, 100, 115,
    111, 108, 99, 67, 0, 8, 17, 0, 51,
];

/// Represents a token withdrawal from the network.
#[derive(Serialize, Deserialize)]
pub struct Withdrawal {
    pub leaf_type: u8,

    pub orig_network: NetworkId,
    pub orig_address: Address,

    pub dest_network: NetworkId,
    pub dest_address: Address,

    pub amount: BigInt,

    pub metadata: Vec<u8>,
}

impl Withdrawal {
    /// Creates a new [`Withdrawal`].
    pub fn new(
        leaf_type: u8,
        orig_network: NetworkId,
        orig_address: Address,
        dest_network: NetworkId,
        dest_address: Address,
        amount: BigInt,
        metadata: Vec<u8>,
    ) -> Self {
        Self {
            leaf_type,
            orig_network,
            orig_address,
            dest_network,
            dest_address,
            amount,
            metadata,
        }
    }

    /// Returns the token address on the destination network.
    pub fn dest_token_address(&self) -> Address {
        let salt =
            keccak256_combine([&self.orig_network.to_be_bytes(), self.orig_address.as_slice()]);
        let init_hash =
            keccak256_combine([BASE_INIT_BYTECODE_WRAPPED_TOKEN.as_slice(), &self.metadata]);

        let hash_output = keccak256_combine([
            &[0xff],
            LXLY_EVM_BRIDGE_ETH_MAINNET_ADDR.as_slice(),
            &salt,
            &init_hash,
        ]);

        // Hash output is 32 bytes, and we drop the first 12 bytes, so this is guaranteed to succeed
        hash_output[12..].try_into().unwrap()
    }

    /// Hashes the [`Withdrawal`] to be inserted in a [`crate::local_exit_tree::LocalExitTree`].
    pub fn hash(&self) -> [u8; 32] {
        keccak256_combine([
            self.leaf_type.as_raw_slice(),
            &u32::to_be_bytes(self.orig_network.into()),
            self.orig_address.as_slice(),
            &u32::to_be_bytes(self.dest_network.into()),
            self.dest_address.as_slice(),
            &self.amount_as_bytes(),
            &keccak256(&self.metadata),
        ])
    }

    /// Prepares the `amount` field for hashing
    fn amount_as_bytes(&self) -> [u8; 32] {
        // FIXME: Ideally, we'd avoid using the heap for this calculation
        let mut amount_bytes = self.amount.to_signed_bytes_be();
        let padding_length = 32 - amount_bytes.len();

        let mut output = Vec::with_capacity(32);
        output.resize(padding_length, 0_u8);
        output.append(&mut amount_bytes);

        output.try_into().unwrap()
    }
}

#[derive(Debug, Clone, Copy, Default, PartialEq, Eq, PartialOrd, Ord, Serialize, Deserialize)]
pub struct NetworkId(u32);

impl NetworkId {
    pub fn new(value: u32) -> Self {
        Self(value)
    }
}

impl From<u32> for NetworkId {
    fn from(value: u32) -> Self {
        Self(value)
    }
}

impl From<NetworkId> for u32 {
    fn from(value: NetworkId) -> Self {
        value.0
    }
}

impl Deref for NetworkId {
    type Target = u32;

    fn deref(&self) -> &Self::Target {
        &self.0
    }
}

#[cfg(test)]
mod tests {
    use base64::{engine::general_purpose::STANDARD, Engine};

    use super::*;
    use crate::local_exit_tree::{hasher::Keccak256Hasher, LocalExitTree};

    #[test]
    fn test_deposit_hash() {
        let mut deposit = Withdrawal {
            leaf_type: 0,
            orig_network: 0.into(),
            orig_address: Address::default(),
            dest_network: 1.into(),
            dest_address: Address::default(),
            amount: BigInt::default(),
            metadata: vec![],
        };

        let amount_bytes = hex::decode("8ac7230489e80000").unwrap_or_default();
        deposit.amount = BigInt::from_signed_bytes_be(amount_bytes.as_slice());

        let dest_addr = hex::decode("c949254d682d8c9ad5682521675b8f43b102aec4").unwrap_or_default();
        deposit.dest_address.copy_from_slice(&dest_addr);

        let leaf_hash = deposit.hash();
        assert_eq!(
            "22ed288677b4c2afd83a6d7d55f7df7f4eaaf60f7310210c030fd27adacbc5e0",
            hex::encode(leaf_hash)
        );

        let mut dm = LocalExitTree::<Keccak256Hasher>::new();
        dm.add_leaf(leaf_hash);
        let dm_root = dm.get_root();
        assert_eq!(
            "5ba002329b53c11a2f1dfe90b11e031771842056cf2125b43da8103c199dcd7f",
            hex::encode(dm_root)
        );
    }

    #[test]
    fn test_dest_token_address() {
        let metadata =  STANDARD.decode("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9XcmFwcGVkIGxpcXVpZCBzdGFrZWQgRXRoZXIgMi4wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGd3N0RVRIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=").unwrap();

        let withdrawal = Withdrawal::new(
            0,
            0.into(),
            address!("7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0"),
            1.into(),
            Address::default(),
            BigInt::default(),
            metadata,
        );

        assert_eq!(
            address!("5D8cfF95D7A57c0BF50B30b43c7CC0D52825D4a9"),
            withdrawal.dest_token_address()
        );
    }
}
